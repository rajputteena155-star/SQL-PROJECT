CREATE DATABASE EMP_REC_2025;
USE EMP_REC_2025;
CREATE TABLE EMP_INFO (
EMP_NAME TEXT (9),
EMP_DEPT TEXT (9),
EMP_SALARY DECIMAL (9,2)
);
CREATE TABLE EMP_ATTENDANCE (
    EMP_ID VARCHAR (4) ,
    EMP_ATTE NUMERIC (9),
    EMP_PERFO VARCHAR (9)
);
CREATE TABLE EMP_SALARY (
    PAYMENT_ID VARCHAR (9), 
    EMP_ID  VARCHAR (9),
    PAY_MONTH TEXT (9), 
    AMT_PAID INTEGER (9), 
    PAY_DATE DATE  
);
ALTER TABLE EMP_INFO  RENAME COLUMN EMP_SALARY TO EMP_BASESAL;
SELECT * FROM EMP_INFO ;
SELECT * FROM EMP_SALARY;
SELECT * FROM EMP_ATTENDANCE;
INSERT INTO EMP_INFO  VALUES ("NOAH", "HR", 50000),
("EMMA", "Finance", 60000),
("LIAM", "IT", 55000),
("OLIVIA", "Marketing", 52000),
("MASON", "Sales", 58000),
("AVA", "Operations", 53000),
("LUCAS", "Engineering", 70000),
("SOPHIA", "Admin", 48000),
("ETHAN", "Support", 51000),
("XAN","OPERATIONS",85000);

INSERT INTO EMP_ATTENDANCE (EMP_ID, EMP_ATTE, EMP_PERFO) VALUES
('E001', 26, 'A1'),
('E002', 24, 'A2'),
('E003', 22, 'B'),
('E004', 27, 'A1'),
('E005', 20, 'B'),
('E006', 25, 'A2'),
('E007', 23, 'B'),
('E008', 28, 'A1'),
('E009', 19, 'B'),
('E010', 26, 'A2');

INSERT INTO EMP_SALARY VALUES ('P001', 'E001', 'January', 50000, '2025-01-31'),
('P002', 'E002', 'January', 48000, '2025-01-31'),
('P003', 'E003', 'January', 45000, '2025-01-31'),
('P004', 'E004', 'February', 52000, '2025-02-28'),
('P005', 'E005', 'February', 47000, '2025-02-28'),
('P006', 'E006', 'March', 49000, '2025-03-31'),
('P007', 'E007', 'March', 46000, '2025-03-31'),
('P008', 'E008', 'April', 55000, '2025-04-30'),
('P009', 'E009', 'April', 43000, '2025-04-30'),
('P010', 'E010', 'May', 51000, '2025-05-31');
SELECT COUNT(DISTINCT EMP_ID) AS Active_Employees
FROM EMP_ATTENDANCE;
SELECT EMP_ID, EMP_ATTE AS DAYS_PRESENT
FROM EMP_ATTENDANCE
WHERE EMP_ID = 'E001';
SELECT PAY_MONTH, SUM(AMT_PAID) AS TOTAL_SALARY
FROM EMP_SALARY
GROUP BY PAY_MONTH;
SELECT 
EMP_ID, (30 - EMP_ATTE) AS ABSENCES
FROM EMP_ATTENDANCE;
SELECT EMP_NAME FROM EMP_INFO WHERE EMP_BASESAL >= 60000;
SELECT EMP_ID FROM EMP_ATTENDANCE WHERE EMP_PERFO = 'A1';
SELECT DISTINCT EMP_PERFO FROM EMP_ATTENDANCE ;
DESC EMP_SALARY ;
SELECT * FROM EMP_SALARY WHERE AMT_PAID BETWEEN 50000 AND 90000;
SELECT EMP_ID FROM EMP_ATTENDANCE WHERE EMP_PERFO IN ('A1','A2');
SELECT EMP_ID FROM EMP_ATTENDANCE WHERE EMP_PERFO NOT IN ('A1','A2');
SELECT * FROM EMP_ATTENDANCE WHERE EMP_ID LIKE '%06';
SELECT *  FROM EMP_SALARY WHERE PAYMENT_ID LIKE 'P00_1';
SELECT *  FROM EMP_SALARY WHERE PAYMENT_ID LIKE 'P0_1';
SELECT * FROM EMP_INFO ORDER BY EMP_DEPT;
SELECT * FROM EMP_SALARY ORDER BY AMT_PAID desc;
UPDATE EMP_SALARY SET AMT_PAID = 100000 WHERE EMP_ID = 'E005';
UPDATE EMP_INFO SET EMP_BASESAL = EMP_BASESAL+1000;
SELECT * FROM EMP_INFO;
SELECT MAX(EMP_BASESAL) FROM EMP_INFO;













